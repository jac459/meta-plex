{
    "name": "Plex",
    "manufacturer": "Plex",
    "type": "AUDIO",
    "version": 2,
    "persistedvariables":{
        "PlexServer": "",
        "IsRegistered": false,
        "ToInitiate": true
    },
    "register":{
        "registerheadertext": "Plex Remote",
        "registerdescription": "Insert here a plex url for library info as described in the setup instructions",
        "command": {"type": "static", "command": ".", "queryresult": "$.*"}        
    },
    "discover": {
        "welcomeheadertext": "Plex Remote",
        "welcomedescription": "powered by meta\nby JAC459",
        "initcommandset":[
            {"label":"", "type":"static", "command":"$RegistrationCode", "queryresult":"", "evalwrite":[{"variable":"PlexServer","value":"DYNAMIK let myPlexServer = {\"ip\":\"\", \"port\":\"\", \"token\":\"\", \"id\":\"\"};  myPlexServer.ip = \"$Result\".split(\"//\")[1].split(\".\")[0].replace(/-/g, \".\"); myPlexServer.port = \"$Result\".split(\"plex.direct:\")[1].split(\"/library/\")[0]; myPlexServer.token = \"$Result\".split(\"&X-Plex-Token=\")[1].split(\"&\")[0]; JSON.stringify(myPlexServer);"}]},
            {"type": "http-rest", "command":"DYNAMIK let ps = $PlexServer; let com = {\"verb\":\"get\",\"call\":\"\", \"headers\":{\"Accept\":\"application/json\"}}; com.call = \"http://\" + ps.ip + \":\" + ps.port + \"/servers?X-Plex-Token=\" + ps.token; JSON.stringify(com);", "queryresult": "$.MediaContainer.Server.", "evalwrite":[{"variable":"PlexServer","value":"DYNAMIK let myPlexServer = $PlexServer; myPlexServer.id = JSON.parse(\"$Result\")[0].machineIdentifier; JSON.stringify(myPlexServer);"}, {"variable":"IsRegistered","value":"DYNAMIK let myPlexServer = $PlexServer; myPlexServer.ip != undefined;"}], "evaldo":[{"test":"DYNAMIK let myPlexServer = $PlexServer; myPlexServer.ip != undefined","then":"__PERSIST", "or":""}]},
            {"type":"http-rest", "command":"DYNAMIK let ps = $PlexServer; let com = {\"verb\":\"get\",\"call\":\"\", \"headers\":{\"Accept\":\"application/json\"}}; com.call = \"http://\" + ps.ip + \":\" + ps.port + \"/devices?X-Plex-Token=\" + ps.token; JSON.stringify(com);", "queryresult":["$.MediaContainer.Device[?(@.name&&@.platform)]"], "evalwrite":[{"variable":"PlexServer","value":"DYNAMIK let myPlexServer = $PlexServer; myPlexServer.clients = JSON.parse(\"$Result\"); JSON.stringify(myPlexServer);"}]}
        ],
        "command": {"type": "static", "command": "DYNAMIK let duplicatePs = $PlexServer;let ps = []; duplicatePs.clients.forEach((dps) => { if (ps.findIndex((psi)=>{return psi.clientIdentifier == dps.clientIdentifier}) < 0) {ps.push(dps)}}) ; ps.forEach((dev)=>{dev.serverAddress = duplicatePs.ip; if (dev.address == \"127.0.0.1\") {dev.address = duplicatePs.ip}; dev.serverPort = duplicatePs.port;dev.token = duplicatePs.token; dev.serverId = duplicatePs.id}); JSON.stringify(ps);", "queryresult": "$.*"}
    },
    "template": {
        "dynamicname": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").name + \" - \" + JSON.parse(\"$Result\").platform DYNAMIK_INST_END",
        "dynamicid": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").clientIdentifier DYNAMIK_INST_END",
        "variables": {
            "MyPlexServer": "DYNAMIK_INST_START DYNAMIK let ps = $PlexServer; ps = JSON.stringify(JSON.stringify(ps)); ps.substring(1, ps.length-1); DYNAMIK_INST_END",
            "PlexToken": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").token DYNAMIK_INST_END",
            "PlexDeviceName": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").name DYNAMIK_INST_END",
            "PlexClientIp": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").serverAddress DYNAMIK_INST_END",
            "PlexClientPort": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").serverPort DYNAMIK_INST_END",
            "PlexIp": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").serverAddress DYNAMIK_INST_END",
            "PlexPort": "DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").serverPort DYNAMIK_INST_END",
            "PlexClientPrefix":"DYNAMIK_INST_START DYNAMIK \"http://\" + JSON.parse(\"$Result\").serverAddress + \":\" + JSON.parse(\"$Result\").serverPort DYNAMIK_INST_END",
            "PlexPrefix":"DYNAMIK_INST_START DYNAMIK \"http://\" + JSON.parse(\"$Result\").serverAddress + \":\" + JSON.parse(\"$Result\").serverPort DYNAMIK_INST_END",
            "PlexSuffix":"DYNAMIK_INST_START DYNAMIK \"X-Plex-Token=\" + JSON.parse(\"$Result\").token DYNAMIK_INST_END",
            "JustKey":"",
            "SecondNavKey":"",
            "RatingKey":"",
            "LibraryKey":"",
            "LibraryAlbumKey":"",
            "LibraryPlayableKey":"",
            "MediaKey":"",
            "ContainerKey":"",
            "BaseImageURL_":"https://raw.githubusercontent.com/jac459/meta-plex/main/pics/",
            "PlayQueueSelectedMetadataItemID":"",
            "PlayQueueID":"",
            "ClientId":"DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").clientIdentifier DYNAMIK_INST_END",
            "ServerId":"DYNAMIK_INST_START DYNAMIK JSON.parse(\"$Result\").serverId DYNAMIK_INST_END",
            "Offset": 0,
            "ListType" : "",
            "ItemImage": "",
            "ItemPlayableImage": "",
            "ItemAlbumImage": "",
            "ItemDetailImage": "",
            "DisplayedPlayed": "",
            "DisplayedImage": "",
            "ItemTitle": "",
            "ItemType": "",
            "ItemTagLine": "",
            "ItemSummary": "",
            "CommandId": "1",
            "VolumePlayed": "50",
            "VolumeSaved": "",
            "Duration": "",
            "AlbumArt": "",
            "Abc": "",
            "Collection": "",
            "Search":"[\" \", \".\", \"?\", \",\", \"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\", \"-\", \"+\", \"=\", \"{\", \"}\", \"[\", \"]\", \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\"]",
            "PlayedKey": "",
            "InputName": "",
            "MyStatus": "",
            "MyState": "",
            "IsPlaying": false,
            "Progress": "",
            "CurrentDuration": "",
            "ActionStatus": ""
        },
        "images": {
            "AlbumCover": {"label": "", "size": "large", "listen": "DisplayedImage"} 
          },  
        "listeners" : {
            "PlexInitialise" : {"type":"http-rest", "ishub":true, "command":"DYNAMIK let ps = $MyPlexServer; let com = {\"verb\":\"get\",\"call\":\"\", \"headers\":{\"Accept\":\"application/json\"}}; com.call = \"http://\" + ps.ip + \":\" + ps.port + \"/clients?X-Plex-Token=\" + ps.token; JSON.stringify(com);", "queryresult":["$.MediaContainer.Server[?(@.name&&@.platform)]"], "evalwrite":[{"variable":"PlexServer","value":"DYNAMIK let myPlexServer = $MyPlexServer; myPlexServer.clients = JSON.parse(\"$Result\"); JSON.stringify(myPlexServer);"}], "pooltime":"30000", "poolduration":""},
            "PlexSubscribe" : {"type":"http-rest", "ishub":true, "command":"{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/timeline/subscribe?port=$PlexPort&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "pooltime":"30000", "poolduration":"", "queryresult" : "$."
                },
            "PlexStatus" : {"type":"http-rest", "ishub":true, "command":"{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/timeline/poll?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "pooltime":"3000", "poolduration":"", "queryresult" : "$.[?(@property === \"machineIdentifier\" && @ === \"$ServerId\")]^", 
                "evalwrite" : [ 
                    {"variable": "CommandId","value":"DYNAMIK Number($CommandId)+1"},
                    {"variable": "Duration","value":"DYNAMIK if (JSON.parse(\"$Result\")[0]) {let dur = JSON.parse(\"$Result\")[0].duration; dur ? dur : 1;} else {\"$Duration\"}"},
                    {"variable": "ContainerKey","value":"DYNAMIK if (JSON.parse(\"$Result\")[0]) {let ck = JSON.parse(\"$Result\")[0].containerKey; if (ck) {let numQueue = Number(ck.split(\"/\")[2]); numQueue= numQueue+1; \"/playQueues/\" + numQueue;}}"},
                    {"variable": "PlayedKey","value":"DYNAMIK if (JSON.parse(\"$Result\")[0]) {JSON.parse(\"$Result\")[0].key;}"},
                    {"variable": "VolumePlayed", "value" : "DYNAMIK if (JSON.parse(\"$Result\")[0]) {JSON.parse(\"$Result\")[0].volume} else {\"$VolumePlayed\"}"},
                    {"variable": "IsPlaying", "value" : "DYNAMIK if (JSON.parse(\"$Result\")[0]) {if (JSON.parse(\"$Result\")[0].state == \"playing\") {true;} else {false;}} else {false}"},
                    {"variable": "Progress", "value" : "DYNAMIK if (JSON.parse(\"$Result\")[0]) {let tim = JSON.parse(\"$Result\")[0].time; tim ? Math.round(100*Number(JSON.parse(\"$Result\")[0].time)/Number($Duration)) : 0} else {\"0\"}"}
                ],
                "evaldo" : [ 
                    {"test":"DYNAMIK if (JSON.parse(\"$Result\")[0] && JSON.parse(\"$Result\")[0].key) {true;} else {false;}", "then":"GETPLAYEDDATA"}
                ]
            }
          },
        "sliders": {
            "VOLUME": {"unit": "db", "listen": "VolumePlayed", "evaldo": [{"test": true, "then": "__VOLUMESET", "or": ""}]},
            "PROGRESS": {"unit": "%", "listen": "Progress", "evaldo": [{"test": true, "then": "__PROGRESSSET", "or": ""}]}
        },
        "labels":{
            "CurrentStatus" : {"label":".", "actionlisten":"", "listen":"DisplayedPlayed"}
        },
        "buttons": {
            "POWER ON": {"label": "", "type": "static", "command": ".", "evaldo":[{"test":true, "then":"__INITIALISE", "or":""}]},
            "__INITIALISE": {"type":"http-rest", "command":"DYNAMIK let ps = $MyPlexServer; let com = {\"verb\":\"get\",\"call\":\"\", \"headers\":{\"Accept\":\"application/json\"}}; com.call = \"http://\" + ps.ip + \":\" + ps.port + \"/clients?X-Plex-Token=\" + ps.token; JSON.stringify(com);", "queryresult":["$.MediaContainer.Server[?(@.name&&@.platform)]"], "evalwrite":[{"variable":"MyPlexServer","value":"DYNAMIK let myPlexServer = $MyPlexServer; myPlexServer.clients = JSON.parse(\"$Result\"); JSON.stringify(myPlexServer);"}]},
            "POWER OFF": {"label": "", "type": "static", "command": ".", "evaldo":[{"test":true, "then":"__CLEANUP", "or":""}]},
            "PLAY TOGGLE": {"label": "", "type": "static", "command": "", "evaldo":[{"test":"DYNAMIK $IsPlaying", "then":"PAUSE", "or":"PLAY"}]},
            "PLAY": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/play?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}, {"variable":"IsPlaying","value":true}]},
            "PAUSE": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/pause?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}, {"variable":"IsPlaying","value":false}]},
            "NEXT": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/skipNext?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "PREVIOUS": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/skipPrevious?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "STOP": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/stop?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "CURSOR LEFT": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/navigation/moveLeft?commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "CURSOR RIGHT": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/navigation/moveRight?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "CURSOR UP": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/navigation/moveUp?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "CURSOR DOWN": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/navigation/moveDown?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "CURSOR ENTER": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/navigation/select?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "BACK": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/navigation/back?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},      

            "GETPLAYEDDATA": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexPrefix$PlayedKey?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*", "evalwrite":[
                {"variable":"DisplayedPlayed","value":"DYNAMIK let beg = JSON.parse(\"$Result\").title + \" - \"; let end = (JSON.parse(\"$Result\").type != \"track\") ? (JSON.parse(\"$Result\").tagline?JSON.parse(\"$Result\").tagline:JSON.parse(\"$Result\").summary) : JSON.parse(\"$Result\").grandparentTitle; beg + end;"},
                {"variable":"DisplayedImage","value":"DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}
            ]},      

            "__FETCHCOLLECTION": {"type":"http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix/library/sections/$LibraryKey/all?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.", "evalwrite":[{"variable":"Collection","value":"$Result"}]},
            "__PLAYMEDIA": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/playMedia?protocol=http&address=$PlexIp&port=$PlexPort&key=/library/metadata/$PlayQueueSelectedMetadataItemID&containerKey=/playQueues/$PlayQueueID&mediaIndex=1&type=$ItemType&offset=$Offset&machineIdentifier=$ServerId&commandID=$CommandId&token=$PlexToken\", \"headers\":{\"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\"}}"},
            "__VOLUMESET": {"label": "", "type": "http-rest", "command": "{\"verb\":\"get\",\"call\":\"$PlexClientPrefix/player/playback/setParameters?volume=$VolumePlayed&address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]},
            "__MUTESET": {"label":"", "type":"mqtt", "command":"DYNAMIK let op = $Output; let mess ={\"transport\":{\"output\":op, \"volume\":{\"is_muted\":$Muted}}}; let toSend = {\"topic\":\"meta/roon\", \"message\":\"\"}; toSend.message = mess; toSend;"},
            "__PROGRESSSET": {"label": "", "type": "http-rest", "command": "DYNAMIK let Pr = Math.round($Progress*Number($Duration)/100); let finalCall = {\"verb\":\"get\",\"call\":\"\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Target-Client-Identifier\":\"$ClientId\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Device-Name\":\"$PlexDeviceName\"}}; finalCall.call = \"$PlexClientPrefix/player/playback/seekTo?offset=\" + Pr + \"&address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&type=video&protocol=http&commandID=$CommandId&$PlexSuffix\"; finalCall;", "evalwrite":[{"variable":"CommandId","value":"DYNAMIK Number($CommandId)+1"}]}
    
        },
        "directories": {
            "BROWSE": {
                "label": "Choose your library",
                "feeders": {
                    "Browse": {"label": "Choose your library", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$BaseImageURL_plex-226049.jpg"},
                        {"type":"static", "command":[], "itemname":"Recently Added", "itemlabel":"Recently Added Items","itemimage":"$BaseImageURL_new.jpg", "evalnext":[{"test":true, "then":"RecentlyAdded"}]}, 
                        {"type":"static", "command":[], "itemname":"On Deck", "itemlabel":"On going items, new episodes...","itemimage":"$BaseImageURL_ondeck.jpg", "evalnext":[{"test":true, "then":"OnDeck"}]}, 
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix/library/sections?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Directory.*","itemname": "DYNAMIK JSON.parse(\"$Result\").title", "itemlabel": "DYNAMIK JSON.parse(\"$Result\").scanner", "itemaction": "", "itemimage": "DYNAMIK if (JSON.parse(\"$Result\").title == \"Movies\") {\"$BaseImageURL_movies.jpg\"} else if (JSON.parse(\"$Result\").title == \"TV Shows\") {\"$BaseImageURL_TV.jpg\"} else if (JSON.parse(\"$Result\").title == \"Photos\") {\"$BaseImageURL_gallery.jpg\"} else if (JSON.parse(\"$Result\").title == \"Home Videos\") {\"$BaseImageURL_camcorder.jpg\"} else if (JSON.parse(\"$Result\").title == \"Music\") {\"$BaseImageURL_music.jpg\"};", "evalwrite": [{"variable": "LibraryKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, {"variable": "ContainerKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, {"variable": "ItemType", "value": "photo"}, {"variable": "ItemImage", "value": "DYNAMIK if (JSON.parse(\"$Result\").title == \"Movies\") {\"$BaseImageURL_movies.jpg\"} else if (JSON.parse(\"$Result\").title == \"TV Shows\") {\"$BaseImageURL_TV.jpg\"} else if (JSON.parse(\"$Result\").title == \"Photos\") {\"$BaseImageURL_gallery.jpg\"} else if (JSON.parse(\"$Result\").title == \"Home Videos\") {\"$BaseImageURL_camcorder.jpg\"} else if (JSON.parse(\"$Result\").title == \"Music\") {\"$BaseImageURL_music.jpg\"};"}], "evaldo":[{"test":true, "then":"__FETCHCOLLECTION", "or":""}], "evalnext":[{"test":"DYNAMIK JSON.parse(\"$Result\").title != \"Photos\"", "then":"BrowseList", "or":"BrowsePicture"}]}
                    ]},
                    "BrowseList": {"label": "Library", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$ItemImage"},
                        {"type":"static", "command":".", "itemname":"Search","itemlabel":"Search Collection", "itemaction":"", "itemUI":"","itemimage":"$BaseImageURL_search.jpg", "evalwrite":[{"variable":"Abc","value":""}], "evalnext":[{"test":true, "then":"BrowseSearch"}]},
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix/library/sections/$LibraryKey/all?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*","itemname": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").parentTitle} else {JSON.parse(\"$Result\").title}", "itemlabel": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").title} else {JSON.parse(\"$Result\").tagline?JSON.parse(\"$Result\").tagline:JSON.parse(\"$Result\").summary}", "itemimage": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"", "evalwrite": [
                            {"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                            {"variable": "LibraryAlbumKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                            {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, 
                            {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, 
                            {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                            {"variable": "ItemAlbumImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                            {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, 
                            {"variable": "ItemPlayableImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                            {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, 
                            {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").tagline ? JSON.parse(\"$Result\").tagline : JSON.parse(\"$Result\").summary"}, 
                            {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, 
                            {"variable": "LibraryPlayableKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}
                        ], "evalnext":[
                            {"test":"DYNAMIK if (JSON.parse(\"$Result\").type == \"artist\") {true;} else {false;}", "then":"BrowseAlbumList", "or":""}, 
                            {"test":"DYNAMIK if (JSON.parse(\"$Result\").key.endsWith(\"children\") && JSON.parse(\"$Result\").type != \"artist\") {true;} else {false;}", "then":"BrowsePlayable", "or":""}, 
                            {"test":"DYNAMIK if (!JSON.parse(\"$Result\").key.endsWith(\"children\") && JSON.parse(\"$Result\").type != \"artist\") {true;} else {false;}", "then":"DetailView", "or":""}
                            ]}
                    ]},
                    "BrowseListFiltered": {"label": "Library", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$ItemImage"},
                        {"type":"static", "command":".", "itemname":"Search","itemlabel":"Search Collection", "itemaction":"", "itemUI":"","itemimage":"$BaseImageURL_search.jpg", "evalnext":[{"test":true, "then":"BrowseSearch"}]},
                        {"type": "static", "command":"DYNAMIK let col = $Collection; if (\"$Abc\".length>0) {col = col.filter((colI) => {return colI.title.toUpperCase().startsWith(\"$Abc\")})};col;", "queryresult":"$.*","itemname": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").parentTitle} else {JSON.parse(\"$Result\").title}", "itemlabel": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").title} else {JSON.parse(\"$Result\").tagline?JSON.parse(\"$Result\").tagline:JSON.parse(\"$Result\").summary}", "itemimage": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"", "evalwrite": [
                            {"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                            {"variable": "LibraryAlbumKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                            {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, 
                            {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, 
                            {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                            {"variable": "ItemAlbumImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                            {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, 
                            {"variable": "ItemPlayableImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                            {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, 
                            {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").tagline ? JSON.parse(\"$Result\").tagline : JSON.parse(\"$Result\").summary"}, 
                            {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, 
                            {"variable": "LibraryPlayableKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}
                        ], "evalnext":[
                            {"test":"DYNAMIK if (JSON.parse(\"$Result\").type == \"artist\") {true;} else {false;}", "then":"BrowseAlbumList", "or":""}, 
                            {"test":"DYNAMIK if (JSON.parse(\"$Result\").key.endsWith(\"children\") && JSON.parse(\"$Result\").type != \"artist\") {true;} else {false;}", "then":"BrowsePlayable", "or":""}, 
                            {"test":"DYNAMIK if (!JSON.parse(\"$Result\").key.endsWith(\"children\") && JSON.parse(\"$Result\").type != \"artist\") {true;} else {false;}", "then":"DetailView", "or":""}
                            ]}
                    ]},
                    "BrowseAlbumList": {"label": "Library", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$ItemAlbumImage"},
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix$LibraryAlbumKey?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*","itemname": "DYNAMIK JSON.parse(\"$Result\").title", "itemlabel": "DYNAMIK JSON.parse(\"$Result\").parentTitle;", "itemimage": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"", 
                            "evalwrite": [
                                {"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                                {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, 
                                {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, 
                                {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                                {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, 
                                {"variable": "ItemPlayableImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, 
                                {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, 
                                {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").tagline ? JSON.parse(\"$Result\").tagline : JSON.parse(\"$Result\").summary"}, 
                                {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, 
                                {"variable": "LibraryPlayableKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}
                            ], 
                            "evalnext":[
                                {"test":"DYNAMIK if (JSON.parse(\"$Result\").parentTitle || JSON.parse(\"$Result\").type == \"artist\") {true;} else {false;}", "then":"BrowsePlayable", "or":"DetailView"}
                            ]}
                    ]},
                    "BrowseSearch":{"label":"Browse", "commandset": [
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$BaseImageURL_search.jpg"},
                        {"type":"static", "command":"DYNAMIK let col = $Collection; if (\"$Abc\".length>0) {col = col.filter((colI) => {return colI.title.toUpperCase().startsWith(\"$Abc\")})}; let srh = $Search; let res = []; let tuple; srh.forEach((seI)=>{let filtok = \"$Abc\" + seI;let interRes = col.filter((colI) => {return colI.title.toUpperCase().startsWith(filtok)}); if (interRes.length>0) {tuple = {\"title\":\"\"}; tuple.abc = filtok; tuple.title = filtok + \" - \" + interRes.length + \" items.\"; tuple.subtitle = interRes[0].title + \" - \" + interRes[interRes.length -1].title; res.push(tuple)}});res;", "queryresult":"$.*", "itemname":"DYNAMIK JSON.parse(\"$Result\").title", "itemlabel":"DYNAMIK JSON.parse(\"$Result\").subtitle", "itemimage":"$BaseImageURL_search.jpg", "evalnext":[{"test":true, "then":"BrowseListFiltered", "or":""}], "evalwrite":[{"variable":"Abc","value":"DYNAMIK JSON.parse(\"$Result\").abc"}]}
                    ]},
                    "BrowsePicture": {"label": "Library", "commandset":[
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix/library/sections/$LibraryKey/all?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "itemtype":"tile", "itemaction":"Set", "queryresult": "$.MediaContainer.Metadata.*", "itemimage": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"", "evalwrite": [{"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, {"variable": "Offset", "value": "0"}, {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}]}
                    ]},
                    "RecentlyAdded": {"label": "Recently added", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$BaseImageURL_new.jpg"},
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix/library/recentlyAdded?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*","itemname": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").parentTitle} else {JSON.parse(\"$Result\").title}", "itemlabel": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").title} else {JSON.parse(\"$Result\").tagline?JSON.parse(\"$Result\").tagline:JSON.parse(\"$Result\").summary}", "itemimage": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"", "evalwrite": [{"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, {"variable": "ItemPlayableImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").tagline ? JSON.parse(\"$Result\").tagline : JSON.parse(\"$Result\").summary"}, {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, {"variable": "LibraryPlayableKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}], "evalnext":[{"test":"DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {true;} else {false;}", "then":"BrowsePlayable", "or":"DetailView"}]}
                    ]},                    
                    "OnDeck": {"label": "On Deck", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$BaseImageURL_ondeck.jpg"},
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix/library/onDeck?address=$PlexIp&port=$PlexPort&machineIdentifier=$ServerId&protocol=http&$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*","itemname": "DYNAMIK JSON.parse(\"$Result\").title", "itemlabel": "DYNAMIK if (JSON.parse(\"$Result\").parentTitle) {JSON.parse(\"$Result\").parentTitle + \" - \" + JSON.parse(\"$Result\").grandparentTitle} else {JSON.parse(\"$Result\").tagline ? JSON.parse(\"$Result\").tagline : JSON.parse(\"$Result\").summary}", "itemimage": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"", "evalwrite": [{"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, {"variable": "ItemPlayableImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}, {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").tagline ? JSON.parse(\"$Result\").tagline : JSON.parse(\"$Result\").summary"}, {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, {"variable": "LibraryPlayableKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}], "evalnext":[{"test":true, "then":"DetailView", "or":""}]}
                    ]},                    
                    "BrowsePlayable": {"label": "Ready to play", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$ItemPlayableImage"},
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix$LibraryPlayableKey/all?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*","itemname": "DYNAMIK JSON.parse(\"$Result\").title", "itemlabel": "DYNAMIK if (JSON.parse(\"$Result\").type != \"track\") {JSON.parse(\"$Result\").tagline?JSON.parse(\"$Result\").tagline:JSON.parse(\"$Result\").summary} else {JSON.parse(\"$Result\").parentTitle}", "itemaction": "", "itemimage": "DYNAMIK if (JSON.parse(\"$Result\").thumb) {\"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"} else {\"$ItemPlayableImage\"}", 
                            "evalwrite": [
                                {"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                                {"variable": "SecondNavKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                                {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, 
                                {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, 
                                {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, 
                                {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, 
                                {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").parentTitle"}, 
                                {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, 
                                {"variable": "ItemAlbumImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""},
                                {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}
                                ], "evalnext":[
                                    {"test":"DYNAMIK if (JSON.parse(\"$Result\").key.endsWith(\"children\")) {true;} else {false;}", "then":"Browse2Playable", "or":""}, 
                                    {"test":"DYNAMIK if (!JSON.parse(\"$Result\").key.endsWith(\"children\")) {true;} else {false;}", "then":"DetailView", "or":""}
                                ]}
                    ]},
                    "Browse2Playable": {"label": "Ready to play", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"", "itemUI":"","itemimage":"$ItemAlbumImage"},
                        {"type": "http-rest", "command":"{\"verb\":\"get\",\"call\":\"$PlexPrefix$SecondNavKey/all?$PlexSuffix\", \"headers\":{\"Accept\":\"application/json\"}}", "queryresult": "$.MediaContainer.Metadata.*","itemname": "DYNAMIK JSON.parse(\"$Result\").title", "itemlabel": "DYNAMIK if (JSON.parse(\"$Result\").type != \"track\") {JSON.parse(\"$Result\").tagline?JSON.parse(\"$Result\").tagline:JSON.parse(\"$Result\").summary} else {JSON.parse(\"$Result\").parentTitle}", "itemaction": "", "itemimage": "DYNAMIK if (JSON.parse(\"$Result\").thumb) {\"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\"} else {\"$ItemPlayableImage\"}", 
                            "evalwrite": [
                                {"variable": "JustKey", "value": "DYNAMIK JSON.parse(\"$Result\").key"}, 
                                {"variable": "ItemType", "value": "DYNAMIK JSON.parse(\"$Result\").type"}, 
                                {"variable": "RatingKey", "value": "DYNAMIK JSON.parse(\"$Result\").ratingKey"}, 
                                {"variable": "Offset", "value": "DYNAMIK let of = JSON.parse(\"$Result\").viewOffset; of ? of : 0;"}, 
                                {"variable": "ItemTitle", "value": "DYNAMIK JSON.parse(\"$Result\").title"}, 
                                {"variable": "ItemTagLine", "value": "DYNAMIK JSON.parse(\"$Result\").parentTitle"}, 
                                {"variable": "ItemSummary", "value": "DYNAMIK JSON.parse(\"$Result\").summary"}, 
                                {"variable": "ItemDetailImage", "value": "DYNAMIK \"$PlexPrefix\" + JSON.parse(\"$Result\").thumb + \"?$PlexSuffix\""}
                                ], "evalnext":[
                                    {"test":"DYNAMIK if (JSON.parse(\"$Result\").key.endsWith(\"children\")) {true;} else {false;}", "then":"BrowsePlayable", "or":""}, 
                                    {"test":"DYNAMIK if (!JSON.parse(\"$Result\").key.endsWith(\"children\")) {true;} else {false;}", "then":"DetailView", "or":""}
                                ]}
                    ]},
                    "DetailView": {"label": "$ItemTitle", "commandset":[
                        {"type":"static", "command":".", "itemtype":"tile", "itemaction":"Set", "itemUI":"","itemimage":"$ItemDetailImage"},
                        {"type":"static", "command":".","itemname": "$ItemTitle - $ItemTagLine","itemlabel": "$ItemSummary", "itemtype":"info"},
                        {"type":"static", "command":".","itemname": "Play from start","itemimage":"$BaseImageURL_Play.jpg", "itemaction":"Set", "evalwrite":[{"variable": "Offset", "value": 0}]},
                        {"type":"static", "command":".","itemname": "Resume","itemimage":"$BaseImageURL_Resume.jpg", "itemaction":"Set"}
                     ]},
                    "Set": {
                        "label": "",
                        "commandset": [
                            {
                                "type": "http-rest",
                                "command": "{\"verb\":\"post\",\"call\":\"$PlexClientPrefix/playQueues?type=video&shuffle=0&repeat=0&continuous=1&own=1&uri=server://$ServerId/com.plexapp.plugins.library/library/metadata/$RatingKey\", \"headers\":{\"Accept\":\"application/json\", \"X-Plex-Client-Identifier\":\"meta\", \"X-Plex-Token\":\"$PlexToken\"}}", "queryresult": "$.MediaContainer.", "evalwrite":[{"variable":"PlayQueueID","value":"DYNAMIK JSON.parse(\"$Result\")[0].playQueueID"}, {"variable":"PlayQueueSelectedMetadataItemID","value":"DYNAMIK JSON.parse(\"$Result\")[0].playQueueSelectedMetadataItemID"}], "evaldo":[{"test":true,"then":"__PLAYMEDIA", "or":""}]
                            }
                        ]
                    }
                }
            }
        }
    }
}